{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#viroconstrictor","title":"ViroConstrictor","text":"<p>ViroConstrictor is a pipeline designed to process raw FastQ data from amplicon-based sequencing experiments and generate a biologically correct consensus sequence of the sequenced genome.</p> <p>ViroConstrictor performs high speed data quality control, data cleanup and high accuracy removal of primer-sequences from NGS reads. As well as alignment of reads and generation of a consensus sequence using the TrueConsense consensus-caller which accounts for sequencing errors and alignment artefacts.</p> <p>ViroConstrictor is able to run both on a standalone (linux) computer, as well as High-Performance Computing (HPC) infrastructures.</p> <p>ViroConstrictor is compatible with Nanopore, Illumina, and IONTorrent data (fastq).</p> <p>Please see the getting started for download and installation instructions, and please see the user guide page page for basic usage instructions.</p> <p>ViroConstrictor is available under the AGPLv3 licence </p>"},{"location":"#authors","title":"Authors","text":"<ul> <li>Florian Zwagemaker</li> <li>Dennis Schmitz</li> <li>Karim Hajji</li> <li>Annelies Kroneman</li> </ul>"},{"location":"amplicons/","title":"Explanation of Amplicon Types","text":"<p>The \"amplicon type\" is basically a description of a PCR amplicon, and which part of said amplicon is actually sequenced. This information is important because given primers will be removed from the reads during the analysis.</p> <p>In the ViroConstrictor pipeline the primer-removal is done by our tool AmpliGone.</p> <p>The information regarding the \"amplicon type\" is required because it tells te pipeline, and therefore also AmpliGone, from which side(s) of a read the primer-sequence has to be removed.</p> <p>Currently there are two options: \"End-to-End\" or \"End-to-Mid\".  </p> <p>In short: \"End-to-End\" means that the sequenced read covers the full length of an amplicon. Meaning that the primer-sequence is present at both ends of a read. \"End-to-Mid\" means that the sequences read only partially covers the length of the amplicon. Meaning that the primer-sequence is present at only one end of a read.</p> <p>Also see the AmpliGone documentation regarding amplicon-types where we go into more detail regarding these types and what these terms mean. Please check your sequencing and laboratory setup for the amplicon type to match your analysis to ensure the best results.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#124-2023-03-02","title":"1.2.4 (2023-03-02)","text":""},{"location":"changelog/#dependencies","title":"Dependencies","text":"<ul> <li>use conda for installing aminoextract instead of pip (1855470)</li> </ul>"},{"location":"changelog/#123-2023-03-01","title":"1.2.3 (2023-03-01)","text":""},{"location":"changelog/#bug-fixes","title":"Bug Fixes","text":"<ul> <li>allow input fastq files that contain multiple dots (07994a2)</li> <li>ensure compability between the Influenza preset and illumina short read data (9a9f1d9)</li> <li>ensure match_preset_name() actually returns all required values (d49f238)</li> <li>update permissions for GH-actions workflows (1f760ba)</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>add citations file (1f760ba)</li> <li>update installation instructions for new environment file and environment creation with Mamba (84183a7)</li> </ul>"},{"location":"changelog/#dependencies_1","title":"Dependencies","text":"<ul> <li>add python-magic version 0.4.27 to environment (84183a7)</li> <li>pin version of AminoExtract to 0.2.1 (84183a7)</li> </ul>"},{"location":"changelog/#122-2023-01-24","title":"1.2.2 (2023-01-24)","text":""},{"location":"changelog/#bug-fixes_1","title":"Bug Fixes","text":"<ul> <li>correctly parse presets when using  a samplesheet (2ca2149)</li> <li>make the ViroConstrictor main entrypoint less case sensitive (43b27aa)</li> </ul>"},{"location":"changelog/#121-2023-01-19","title":"1.2.1 (2023-01-19)","text":""},{"location":"changelog/#bug-fixes_2","title":"Bug Fixes","text":"<ul> <li>correction in argument parser to avoid a NoneType AttributeError when all required information is passed through commandline options (f2acedf)</li> </ul>"},{"location":"changelog/#dependencies_2","title":"Dependencies","text":"<ul> <li>correct the <code>rich</code> version in all base environment files (f2acedf)</li> </ul>"},{"location":"changelog/#120-2023-01-18","title":"1.2.0 (2023-01-18)","text":""},{"location":"changelog/#features","title":"Features","text":"<ul> <li>add option to filted for minimum aligned length in <code>clipper.py</code> (d06caf5)</li> <li>add option to filter spliced reads in <code>clipper.py</code> (d06caf5)</li> <li>add support for working with presets for specific viral targets (29bfa3c)</li> </ul>"},{"location":"changelog/#bug-fixes_3","title":"Bug Fixes","text":"<ul> <li>add <code>.gff3</code> file extension as allowed to features flag (b4fdf5d)</li> <li>change Clipper settings to a per-platform config per preset (3d952bb)</li> <li>change the minimal alignment length in <code>clipper.py</code> to be a percentage of the reference length (68597e8)</li> <li>correct minimum aligned read length default value (60b9230)</li> <li>Fix extension checking for input files (6c4f91e)</li> <li>set snakemake <code>keepgoing</code> to True as a default (0076d52)</li> <li>use the correct columns of input BED file when there are more columns given than necessary (56b5259)</li> <li>workaround for <code>Argument list too long</code> error when parsing complex workflows (2835c44)</li> </ul>"},{"location":"changelog/#performance-improvements","title":"Performance Improvements","text":"<ul> <li>change <code>make_pickle</code> rule to localrule (f41cc01)</li> <li>change threads in local execution mode to improve parallel performance (869c81a)</li> </ul>"},{"location":"changelog/#dependencies_3","title":"Dependencies","text":"<ul> <li>add <code>Rich</code> as a dependency with version 13.. (e63cac7)</li> <li>update AmpliGone to version 1.2.0 (dfb22f1)</li> </ul>"},{"location":"changelog/#documentation_1","title":"Documentation","text":"<ul> <li>update documentation to include presets functionalities (adc5265)</li> </ul>"},{"location":"changelog/#110-2022-12-06","title":"1.1.0 (2022-12-06)","text":""},{"location":"changelog/#features_1","title":"Features","text":"<ul> <li>add base of functionality to translate and write amino acid sequences (25884b7)</li> <li>translate and extract aminoacids sequences for multiple targets (657aaff)</li> </ul>"},{"location":"changelog/#bug-fixes_4","title":"Bug Fixes","text":"<ul> <li>add the missing \"FORWARD\" and \"REVERSE\" primer keywords (74b92c6)</li> <li>change found features to <code>np.nan</code> if input reference and features file don't match (3e812e4)</li> <li>circumvent issue where null values cause problems in data translation steps (6007fca)</li> <li>correctly parse amino acids that have a name with a dot in it (3e14dd5)</li> <li>make sure all required info is present when no gff files are given (d589989)</li> </ul>"},{"location":"changelog/#documentation_2","title":"Documentation","text":"<ul> <li>clarify some sections in the docs (9bc4171)</li> <li>fix broken links (9bc4171)</li> <li>update documentation to match new functionality (9bc4171)</li> </ul>"},{"location":"changelog/#dependencies_4","title":"Dependencies","text":"<ul> <li>add AminoExtract to dependency list (acb378e)</li> <li>change minimal python version to 3.10 (acb378e)</li> <li>pin AminoExtract version to v0.2.0 (cce1cf9)</li> <li>pin AminoExtract version to v0.2.1 (c0e869f)</li> <li>update TrueConsense to v0.5.0 and change rules accordingly (af15b9c)</li> <li>update TrueConsense version to 0.5.1 (b1a61e4)</li> </ul>"},{"location":"changelog/#104-2022-11-01","title":"1.0.4 (2022-11-01)","text":""},{"location":"changelog/#bug-fixes_5","title":"Bug Fixes","text":"<ul> <li>cleanly exit vcf_to_tsv.py script when vcf is empty after filtering (037467b)</li> <li>replace bcftools with python script to avoid bcftools shared libraries error (eefaead)</li> </ul>"},{"location":"changelog/#dependencies_5","title":"Dependencies","text":"<ul> <li>remove bcftools as a dependency (eefaead)</li> <li>remove the entire Mutations environment as it is no longer necessary (eefaead)</li> </ul>"},{"location":"changelog/#103-2022-10-12","title":"1.0.3 (2022-10-12)","text":""},{"location":"changelog/#dependencies_6","title":"Dependencies","text":"<ul> <li>pin snakemake to version 7.15.2 for dependency compatibility (0914b56)</li> <li>set snakemake 7.15.2 as a minimal version in setup.py (0914b56)</li> </ul>"},{"location":"changelog/#102-2022-08-15","title":"1.0.2 (2022-08-15)","text":""},{"location":"changelog/#dependencies_7","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.1.0 (153719d)</li> <li>update included snakemake version to 7.12.x (e59edf9)</li> <li>use the bioconda channel to install AmpliGone instead of pip (0f1fd65)</li> </ul>"},{"location":"changelog/#101-2022-04-26","title":"1.0.1 (2022-04-26)","text":""},{"location":"changelog/#bug-fixes_6","title":"Bug Fixes","text":"<ul> <li>correctly exit amplicon_coverage calc when only one side of an amplicon could be found combined with low coverage samples (aa77006)</li> <li>ensure the split reference sequences are always in uppercase (fcf034c)</li> </ul>"},{"location":"changelog/#100-2022-04-14","title":"1.0.0 (2022-04-14)","text":""},{"location":"changelog/#breaking-changes","title":"\u26a0 BREAKING CHANGES","text":"<ul> <li>Use a single coverage level during analysis, defaults to 30 (6d6fc01)</li> <li>add support for per-sample analysis settings with an input samplesheet in Excel, TSV or CSV format (a0b726)</li> <li>Add support for BED files in amplicon_covs (ece3dfa)</li> <li>Use BED files as output of AmpliGone (79fd23)</li> <li>Update to python version 3.10 in base environments. (minimal required version = 3.8) (184328)</li> <li>Use a single coverage level for TrueConsense (e5701b9a)</li> </ul>"},{"location":"changelog/#features_2","title":"Features","text":"<ul> <li>flexible snakemake rule_all based on samplesheet inputs (93ad0c)</li> <li>use the snakemake Paramspace for wildcard generation (94d1738)</li> <li>Add remove_adapters_p1 to all (64c9069)</li> <li>Add remove_adapters_p2 and qc_filter to all (a89560)</li> <li>Add prepare_primers (6dc7c9)</li> <li>Add prepare_gff rule (a0bc0fb)</li> <li>Re-add ampligone (89cc2a0)</li> <li>Re-add qc_post to multiqc (45c0d12)</li> <li>Re-add TrueConsense (44f36c1)</li> <li>Re-add concat_seq (ab229de)</li> <li>Re-add tsv output (5bf10aa)</li> <li>Re-add breadth of coverage to snakefile (003b2f)</li> <li>Re-add amplicon_cov (6f6088)</li> <li>Correctly handle missing inputs in samplesheet (aa6995)</li> <li>re-add illumina support in new workflow structure (8eb400)</li> <li>add fastP stats to multiqc report (19627f)</li> </ul>"},{"location":"changelog/#bug-fixes_7","title":"Bug Fixes","text":"<ul> <li>Add option to not give primers on cli (e4c054c)</li> <li>Check combination of samplesheet and cli args (e4c054c)</li> <li>Fix broken snakefile (a704c5e)</li> <li>Add .bed as filetype for primers (f16556)</li> <li>Make prodigal and prepare_gff unique (761337)</li> <li>Fix aggregation outputs to rule all (2269340)</li> <li>Fix restructuring of results folder (76fda46)</li> <li>group concatenated files in correct results subfolders (f3f1d9e)</li> <li>Make sure all post_qc is added in multiqc (b51f0ce)</li> <li>Remove excess bracket in various log&amp;bench rules (4a5e96c)</li> <li>add logs for calculate_amplicon_cov rule (fbd2c1c)</li> <li>always use absolute path for input reference, primer and features files (fa68a7a)</li> <li>always provide absolute path for input fastq files (0303244)</li> <li>Raise error if fasta contains invalid char (5209a7b)</li> <li>Bump minimum snakemake version (a31b503)</li> <li>change multiqc memory requirements to 'high' (05b9db3)</li> <li>filter input primer bedfile to only output matching refID bedfile (c2b9c0c)</li> </ul>"},{"location":"changelog/#code-refactoring","title":"Code Refactoring","text":"<ul> <li>move version to init file (e4c054c)</li> <li>Remove empty.primers (bfe0044)</li> <li>use the snakemake Paramspace wildcards in the multiQC aggregation (1204b09)</li> <li>add the \"extract_refs.py\" script to repo (5a7ea4)</li> <li>move multiqc input function to top of snakefile (1134bb)</li> <li>use new prepare_primers rule in new structure (4d06939)</li> <li>use new prepare_gffs rule with the new structure (537d09)</li> <li>add basic gff filter script (09ada9)</li> <li>Refactor with bottum up approach (682cafa)</li> <li>Rename Sample to sample (a6c0e48)</li> <li>Change to wc_pattern (214e21)</li> <li>Switch wc_pattern to wc_folder (40d4d2e)</li> <li>Remove threads: 1 as it is default (5cd6ca6)</li> <li>Make wildcard notation consistent (8fe4f7e)</li> <li>Re-ordering of code (b3d891)</li> <li>Remove mincov variable in snakefile (5bb47a9)</li> <li>change used fonts in the generated report to accomodate fpdf2 (5bb91d1)</li> <li>merge if statement blocks to singular condition (7b2882f)</li> <li>simplify boolean returns (615d2cf)</li> <li>use new expression for conditional in samplesheet generator (8ca585a)</li> </ul>"},{"location":"changelog/#dependencies_8","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.0.1 (e4c054c)</li> <li>update TrueConsense version to v0.4.0 (e4c054c)</li> <li>use Pypi for AmpliGone installation instead of building from source (e4c054c)</li> <li>add python3.7 to the Alignment env for improved env-stability (d87c746)</li> <li>update snakemake to lenient version 7.3 (56d8fe)</li> </ul>"},{"location":"changelog/#documentation_3","title":"Documentation","text":"<ul> <li>Add information for primer bed support (e4c054c)</li> <li>update docs for multi-target analysis (e4c054c)</li> <li>update documentation for new ViroConstrictor functions (e4c054c)</li> <li>update installation command for python3.10 (e4c054c)</li> <li>update documentation index page with correct required snakemake version (e4c054c)</li> <li>Add explanatory docstring to <code>CheckSampleProperties</code> function (4a552ad)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.parser</code> (b09f4d)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.runconfigs</code> (2ff8185)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.samplesheet</code> (a1e7093)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.userprofile</code> (30ec8af8)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.validatefasta</code> (c199d7c9)</li> <li>Add error message for samplesheet duplicates (efa0761)</li> </ul>"},{"location":"changelog/#042-2022-04-12","title":"0.4.2 (2022-04-12)","text":""},{"location":"changelog/#bug-fixes_8","title":"Bug Fixes","text":"<ul> <li>limit the self-updater to only update minor and patch versions (f864f55)</li> </ul>"},{"location":"changelog/#041-2022-03-08","title":"0.4.1 (2022-03-08)","text":""},{"location":"changelog/#bug-fixes_9","title":"Bug Fixes","text":"<ul> <li>correct the memory assignment and threads for RemovePrimers job when no primers are given (a9ebe02)</li> </ul>"},{"location":"changelog/#040-2022-02-04","title":"0.4.0 (2022-02-04)","text":""},{"location":"changelog/#features_3","title":"Features","text":"<ul> <li>add an adjustable mismatch rate for the primer search (7fc4265)</li> <li>dynamically set usable cpus/threads in local execution mode (1ec85bb)</li> <li>Write a short report with the used/configured settings of the analysis (0c46366)</li> </ul>"},{"location":"changelog/#bug-fixes_10","title":"Bug Fixes","text":"<ul> <li>add missing --skip-updates flag (f360161)</li> <li>corrected update function parameters (7f37d90)</li> <li>finish an analysis when empty input fastq files are given (d178587)</li> <li>properly exit with right exit codes and print closing message (f1bbe13)</li> </ul>"},{"location":"changelog/#performance-improvements_1","title":"Performance Improvements","text":"<ul> <li>tweak read qc filtering settings (b3aab5a)</li> <li>use adjusted mm2 mapping settings in nanopore-mode (c027daa)</li> </ul>"},{"location":"changelog/#dependencies_9","title":"Dependencies","text":"<ul> <li>add FPDF version 1.7.2 to dependency lists (cfcd9ee)</li> <li>add lenient version requirements to mamba (07ebfcc)</li> <li>add urllib3 v1.26 to dependency list for the auto-updater (cfcd9ee)</li> <li>change biopython version in python setupfile (07ebfcc)</li> <li>change pysam to lenient versioning (cfcd9ee)</li> <li>inlcude conda (lenient) version 4.11.x in main env for compatibility (cfcd9ee)</li> <li>pin pysamstats version to 1.1.2 (cfcd9ee)</li> <li>pin tqdm (lenient) version to 4.62.x (cfcd9ee)</li> <li>pin TrueConsense to version 0.3.0 (cfcd9ee)</li> <li>remove pysamstats from 'clean' environment (cfcd9ee)</li> <li>update AmpliGone 0.4.0 \u2192 0.4.1 (ea06728)</li> <li>update AmpliGone 0.4.1 \u2192 0.4.3 (af62d22)</li> <li>update AmpliGone version 0.2.3 \u2192 0.4.0 (cfcd9ee)</li> <li>update bcftools 1.12 \u2192 1.14 (cfcd9ee)</li> <li>update bedtools 2.29.2 \u2192 2.30.0 (cfcd9ee)</li> <li>update biopython 1.78 \u2192 1.79 (cfcd9ee)</li> <li>update fastp 0.20.1 \u2192 0.23.2 (cfcd9ee)</li> <li>update fastqc 0.11.8 \u2192 0.11.9 (cfcd9ee)</li> <li>update minimap2 &amp; mappy 2.17 \u2192 2.24 (cfcd9ee)</li> <li>update multiqc 1.9 \u2192 1.11 (cfcd9ee)</li> <li>update pandas 1.2.3 \u2192 1.3.5 (cfcd9ee)</li> <li>update parmap 1.5.2 \u2192 1.5.3 (cfcd9ee)</li> <li>update PyYaml 5.4.1 \u2192 6.0 (cfcd9ee)</li> <li>update samtools 1.11 \u2192 1.14 (cfcd9ee)</li> <li>update seqkit 0.14.0 \u2192 2.1.0 (cfcd9ee)</li> <li>update snakemake 6.4.1 \u2192 6.13.1 (cfcd9ee)</li> </ul>"},{"location":"changelog/#documentation_4","title":"Documentation","text":"<ul> <li>add importance of primer name and number to docs (7107398)</li> <li>include primer mismatch rate flag to documentation (531f526)</li> <li>update installation instructions (5944d22)</li> </ul>"},{"location":"changelog/#030-2021-11-15","title":"0.3.0 (2021-11-15)","text":""},{"location":"changelog/#features_4","title":"Features","text":"<ul> <li>allow ViroConstrictor to update itself to latest release (11ad616)</li> <li>flexible memory requirements per workflow job (7c189cd)</li> </ul>"},{"location":"changelog/#bug-fixes_11","title":"Bug Fixes","text":"<ul> <li>change consensus calling to a 'mid' cpu-task (3094b78)</li> </ul>"},{"location":"changelog/#023-2021-11-03","title":"0.2.3 (2021-11-03)","text":""},{"location":"changelog/#documentation_5","title":"Documentation","text":"<ul> <li>add explanatory comments to docs config (f3e05ec)</li> </ul>"},{"location":"changelog/#022-2021-11-03","title":"0.2.2 (2021-11-03)","text":""},{"location":"changelog/#bug-fixes_12","title":"Bug Fixes","text":"<ul> <li>change amplicon covs script to complete with empty input #5 (6900638)</li> <li>complete workflow with primers set to NONE (47becf8)</li> <li>use 'map-ont' mm2 preset in nanopore workflow (f89d5cf)</li> </ul>"},{"location":"global-config/","title":"Configuration options","text":"<p>When you first run ViroConstrictor you will be asked to set some global configuration settings. These settings are used every time you execute ViroConstrictor and tell the application how the analysis, or even the entire application, should behave.</p> <p>There's two main sections of global configuration that need to be set up:</p> <ol> <li>The computing settings which ViroConstrictor will use when running the analysis.</li> <li>The updating-behavior of the ViroConstrictor application.</li> </ol> <p>ViroConstrictor will store the information you provide during this first setup so you won't have to provide this information every time you run an analysis.</p>"},{"location":"global-config/#setting-up-computing-settings","title":"Setting up computing settings","text":"<p>You will be asked to provide the information which tells ViroConstrictor where the actual analysis should be executed. ViroConstrictor is able to run both on your local (linux) machine as well as High Performace Computing (HPC/grid) infrastructures.</p> <p>You will therefore be asked in which computing-mode you want ViroConstrictor to run. The options are local or grid mode.</p> What is local execution mode? <p>Local execution mode means that every step of the ViroConstrictor analysis will be performed on the computer where you turned on said analysis. Use this option when you're running ViroConstrictor on your own computer or if you don't know if your analysis environment has a grid infrastructure.</p> What is grid execution mode? <p>Grid execution mode means that every step of the ViroConstrictor analysis will be performed on other computers within the computing-infrastructure. This allows a large amount of analysis steps to be performed in parallel.</p> <p>If you choose the grid computing-mode then you'll be asked a follow up question regarding the computing-queue. High Performance Computing infrastructures are often set up with task-queues for its users. With these queues it's possible to determine on which (remote) computers the various analysis tasks will be executed and which tasks have priority over other types of tasks. You will therefore be asked to provide the name of the computing-queue that you wish to use during analysis with ViroConstrictor. If you don't know the computing-queue then please check with your system administrator beforehand.</p>"},{"location":"global-config/#updating-settings","title":"Updating settings","text":"<p>ViroConstrictor is able to update itself to newer minor and patch versions. During the initial configuration setup you will be asked your preferences regarding the auto-updating features.</p> <p>When auto-updating is enabled, ViroConstrictor will update itself to the latest possible version without asking you first. When this setting is enabled then ViroConstrictor will only let you know it has updated to the latest possible version, or when it was unable to update itself to the latest version.</p> <p>If you choose to disable auto-updating during the configuration then you'll get a follow-up question if instead of completely automatic updates you wish to be asked to update to the latest version. For most use-cases, this is the preferred option where you can still have ViroConstrictor update itself but you stay in control of the used version.</p>"},{"location":"input-formatting/","title":"Formatting your inputs","text":"<p>For optimal results and the best analysis of your data, it is important that the various inputs you may provide are formatted correctly. Formatting of the input is particularly of importance for the input primers file, the reference fasta, and the GFF file.</p> <p>When formatting the inputs please note that ViroConstrictor does not support circular reference information (and related information). Analysing a circular virus, such as HPV, is possible as long as the analysis itself happens with a 'linear' input reference and matching primers/GFF.</p>"},{"location":"input-formatting/#formatting-your-input-primers","title":"Formatting your input primers","text":"<p>ViroConstrictor has two options for primer input: BED and fasta. The formatting of the input primer names may directly impact your analysis results.</p>"},{"location":"input-formatting/#primers-in-fasta-format","title":"Primers in Fasta format","text":"<p>In order to get optimal results, please make sure the fasta headers in your fasta file with primers are formatted properly.  </p> <p>Please make sure the fasta headers for your primers are formatted according the following format: <code>&gt;{primer-name}_{primer-number}_{orientation}</code></p> <p>It's important that the primers which together form a single amplicon have the same primer-name and number.  </p> <p>Orientation keywords for forward primers are: \"LEFT\"/\"PLUS\"/\"POSITIVE\"/\"FORWARD\" Orientation keywords for reverse primers are: \"RIGHT\"/\"MINUS\"/\"NEGATIVE\"/\"REVERSE\"</p> <p>Example of formatted primer names from the ArticV3 SARS-CoV-2 sequencing protocol</p> <pre><code>&gt;nCoV-2019_1_LEFT  \nACCAACCAACTTTCGATCTCTTGT  \n&gt;nCoV-2019_1_RIGHT  \nCATCTTTAAGATGTTGACGTGCCTC  \n&gt;nCoV-2019_2_LEFT  \nCTGTTTTACAGGTTCGCGACGT  \n&gt;nCoV-2019_2_RIGHT  \nTAAGGATCAGTGCCAAGCTCGT\n</code></pre> <p>If your protocol has alternative primers then make sure the fasta header contains the \"alt\" keyword in the following format:</p> <p><code>&gt;{primer-name}_{primer-number}_alt_{orientation}</code> </p> <p>Please make sure the \"alt\" keyword is in the middle and not at the end of the fasta header.</p> <p>Example of formatted primer names from the ArticV3 SARS-CoV-2 sequencing protocol with alternative primers included</p> <pre><code>&gt;nCoV-2019_13_LEFT  \nTCGCACAAATGTCTACTTAGCTGT  \n&gt;nCoV-2019_13_RIGHT  \nACCACAGCAGTTAAAACACCCT  \n&gt;nCoV-2019_14_LEFT  \nCATCCAGATTCTGCCACTCTTGT  \n&gt;nCoV-2019_14_alt_LEFT  \nTGGCAATCTTCATCCAGATTCTGC  \n&gt;nCoV-2019_14_RIGHT  \nAGTTTCCACACAGACAGGCATT  \n&gt;nCoV-2019_14_alt_RIGHT  \nTGCGTGTTTCTTCTGCATGTGC  \n&gt;nCoV-2019_15_LEFT  \nACAGTGCTTAAAAAGTGTAAAAGTGCC  \n&gt;nCoV-2019_15_alt_LEFT  \nAGTGCTTAAAAAGTGTAAAAGTGCCT  \n&gt;nCoV-2019_15_RIGHT  \nAACAGAAACTGTAGCTGGCACT  \n&gt;nCoV-2019_15_alt_RIGHT  \nACTGTAGCTGGCACTTTGAGAGA\n</code></pre>"},{"location":"input-formatting/#primers-in-bed-format","title":"Primers in BED format","text":"<p>As with the primers in fasta format, it is important the primer name is formatted properly in the given BED file. This is mainly important for determining which primers together form a single amplicon. When using a BED file, the 'strand' column is leading in determining the orientation of the primer.</p> <p>Please make sure of the following:</p> <ul> <li> <p>The content of first column, described as the reference ID column underneath, must contain the identifier matching the identifier of your reference fasta.</p> </li> <li> <p>The fourth column, being the primer name, follows the following format: <code>{primer-name}_{primer-number}_{orientation}</code> </p> <p>if your protocol has alternative primers then make sure the primer name contains the \"alt\" keyword as follows: <code>{primer-name}_{primer-number}_alt_{orientation}</code></p> </li> <li> <p>The sixth colum, being the \"strand\" column, indicates the orientation of the primer. <code>+</code> being forward and <code>-</code> being reverse, relative to the reference.</p> </li> </ul> <p>The table below gives you an impression what your BED file with primer information should look like, please note however that a real BED file does not have headers. </p> Reference ID start coordinate stop coordinate primer name score strand MN908947.3 25 50 ncov-2019_1_LEFT . + MN908947.3 324 344 ncov-2019_2_LEFT . + MN908947.3 408 431 ncov-2019_1_RIGHT . - MN908947.3 644 666 ncov-2019_3_LEFT . + MN908947.3 705 727 ncov-2019_2_RIGHT . -"},{"location":"input-formatting/#formatting-your-input-reference-fasta","title":"Formatting your input reference fasta","text":"<p>The formatting of your reference fasta is pretty straightforward, and there are no breaking requirements.  </p> <p>Make sure however that your reference sequence has a proper identifier in the fasta header as this will be used during analysis.</p> <p>Nucleotide ambiguity codes in your reference fasta are supported but generally discouraged as this can have a negative effect on the primer removal process. You will get a warning during pre-processing if ambiguity nucleotides were found in your reference sequence.  </p> <p>If you provide a reference fasta containing multiple sequences then analysis will be performed for every individual sequence in your input reference fasta, this will be split based on the reference identifier. This can be used in analysis of (for example) segmented viruses such as Influenza.</p>"},{"location":"input-formatting/#formatting-your-input-gff","title":"Formatting your input GFF","text":"<p>Formatting of your input GFF is usually optional and very minimal.  </p> <p>If you wish to have proper extraction and translation of aminoacids from the generated consensus sequence, then please make sure the input GFF has either a \"Name\" or an \"ID\" value in the attributes column of your input GFF.</p> <p>For example: <code>Name=\"Nucleocapsid\"</code> or <code>ID=\"N\"</code> in the attributes column of your input GFF.</p> <p>This information will be used to group the extracted aminoacid sequences of samples together during analysis.</p>"},{"location":"installation/","title":"Installation","text":"<p>ViroConstrictor is only available on Linux (or Linux-based) operating systems. MacOS may also work but is not tested. ViroConstrictor will not work on Windows.  </p> <p>Download and installation instructions through Conda will be made available as soon as possible. Until then, please perform manual installation as described on this page below.</p>"},{"location":"installation/#download","title":"Download","text":"<p>Use the following command to download the latest release of ViroConstrictor and move to the newly downloaded <code>ViroConstrictor/</code> directory:</p> <pre><code>git clone https://github.com/RIVM-bioinformatics/ViroConstrictor.git; cd ViroConstrictor; git checkout tags/$(git tag --sort=committerdate | tail -1) &gt;&gt; /dev/null\n</code></pre> <p>Tip</p> <p>If you want to download a specific version of ViroConstrictor then please use the following command below where you replace <code>{VERSION}</code> with the version that you want.</p> <pre><code>git clone --depth 1 -b {VERSION} https://github.com/RIVM-bioinformatics/ViroConstrictor.git; cd ViroConstrictor\n</code></pre>"},{"location":"installation/#installation_1","title":"Installation","text":"<p>Before you install ViroConstrictor, make sure Conda and Mamba are installed on your system and functioning properly!</p> <ol> <li> <p>Create the required conda-environment and install the necessary dependencies.     Copy and paste the code-snippet below to create the new environment and directly activate it.      <pre><code>mamba env create -f env.yml; conda activate ViroConstrictor\n</code></pre></p> Click here if that code-snippet did not work for you <p>if you get errors from Mamba, you can also try the following command(s): <pre><code>conda env create -f env.yml &amp;&amp; conda activate ViroConstrictor\n</code></pre></p> <p>The \"ViroConstrictor\" environment should now be active  </p> </li> <li> <p>You can now actually install ViroConstrictor on your system with: <pre><code>pip install .\n</code></pre></p> Click here if that command did not work for you <p>If you get errors from <code>pip</code>, you can also try the following command:  <pre><code>python setup.py install\n</code></pre></p> </li> </ol> <p>ViroConstrictor is now installed! You can start ViroConstrictor from anywhere on your system as long as the ViroConstrictor conda-environment is active. You can also use the ViroConstrictor pipeline in a different conda-environment as long as the software dependencies match.</p>"},{"location":"manual/","title":"Starting an analysis","text":"<p>Once ViroConstrictor is installed you can use it to analyse your NGS FastQ data.  </p> <p>You can run an analysis in two ways:</p> <ol> <li>A single-target analysis with run-wide parameters (the information that you give is applied to every sample in the analysis)</li> <li>A multi-target analysis where you provide a samplesheet (in excel, .csv or .tsv format) which contains information to run the analysis with different settings for every sample.</li> </ol> <p>Please see <code>viroconstrictor -h</code> for all command-line options</p>"},{"location":"manual/#overview-of-command-line-options","title":"Overview of command-line options","text":"<p>Below, you can find a brief summary if all available command line options and their meaning.</p> Command Argument Explanation <code>--input</code> /<code>-i</code> [input directory] This is the folder containing your input fastq files.Both absolute as relative paths are supported. <code>--output</code> /<code>-o</code> [output directory] This is the desired output folder with all data and results.If the desired folder doesn't exist yet then it will be created. <code>--reference</code> /<code>-ref</code> [reference fasta] Input reference sequence genome in FASTA format <code>--primers</code> /<code>-pr</code> [primer fasta] / <code>NONE</code> Used primer sequences in FASTA format.Use <code>NONE</code> if your sequencing protocol does not use primers <code>--features</code> /<code>-gff</code> [GFF file] / <code>NONE</code> The GFF3 file containing the genomic features (open reading frames etc.) matching the given reference fasta.Use <code>NONE</code> if you don't have access to a GFF3 file containing this information. <code>--platform</code> <code>nanopore</code> / <code>illumina</code> / <code>iontorrent</code> The sequencing platform that was used to generate the dataset. Either being 'nanopore', 'illumina' or 'iontorrent'.Default is <code>nanopore</code> <code>--amplicon-type</code> /<code>-at</code> <code>end-to-end</code> / <code>end-to-mid</code> / <code>fragmented</code> The amplicon type that matches your sequencing experiment/protocol.Either being <code>end-to-end</code>,<code>end-to-mid</code>, or <code>fragmented</code> <code>--min-coverage</code> /<code>-mc</code> Minimum coverage The minimum coverage for the consensus sequence(s)Default is 30 <code>--primer-mismatch-rate</code>/<code>-pmr</code> Fraction of maximum primer mismatches The maximum percentage mismatches that is tolerated during the primer search. Mismatches are counted in substitutions between primer and reference. Insertions and/or deletions are not taken into account.Default is 0.1 (10%)This means that max 10% of the length of a primer may be a mismatch, i.e. if your primer is 30nt then maximum 3 mismatches are allowed <code>--target</code> /<code>--preset</code> Name of the viral target The basic descriptive name of the viral target that is being analysedi.e. \"Measles\", \"Sars-CoV-2\", \"HPV16\", or \"Influenza_A\"This viral target will be used as an analysis-preset if there is a preset available for the given viral target. If no preset is available for the given target then default settings will be used. Disable the use of analysis-presets with the <code>--disable-presets</code> flag. <code>--disable-presets</code> /<code>-dp</code> N/A Switches off the use of analysis presets, default analysis settings will be used for all given samples/viral-targets. It is still necessar to provide the information of viral-target. <code>--threads</code> /<code>-t</code> Amount of threads Number of local threads that are available to use.Default is the number of available threads in your system <code>--dryrun</code> N/A Run the ViroConstrictor workflow without actually doing anything.(default: False) <code>--skip-updates</code> N/A Skip the check for a new version <code>--version</code> /<code>-v</code> N/A Shows the current version of ViroConstrictor and exits <code>--help</code> /<code>-h</code> N/A Show the ViroConstrictor help document and exits"},{"location":"manual/#run-a-single-target-analysis","title":"Run a single-target analysis","text":"<p>When running ViroConstrictor as a single-target analysis its possible to provide all necessary information via the command line. The given information will be applied to all samples in the analysis.</p> <p>To run an analysis, you need to provide (at least) the following inputs/information:  </p> <ul> <li>The input directory containing your FastQ data via the <code>--input</code>/<code>-i</code> flag</li> <li>The desired output directory for results and data via the <code>--output</code>/<code>-o</code> flag</li> <li>The path to a reference fasta file via the <code>--reference</code>/<code>-ref</code> flag</li> <li> <p>Used sequencing primers in correct fasta format or as a bed-file via the <code>--primers</code>/<code>-pr</code> flag  </p> <p>If you did not use any primers during your sequencing run then provide <code>--primers NONE</code> on the command line</p> </li> <li> <p>A GFF file containing the genomic features of the given reference file via the <code>--features</code>/<code>-gff</code> flag</p> <p>If you don't have access to a GFF file with genomic features matching the reference then provide <code>--features NONE</code>. ViroConstrictor will then attempt to guess the genomic features of the given reference during analysis.  </p> <p>However, amino acid translations of the genomic features will not be provided in the results folder when no GFF file is given, if amino acid translations are desired then an input GFF file matching your reference fasta is required. </p> </li> <li> <p>The used sequencing platform via <code>--platform</code>, can be \"nanopore\", \"illumina\", or \"iontorrent\"</p> </li> <li> <p>The Amplicon-type in your provided data via the <code>--amplicon-type</code>/<code>-at</code> flag.  </p> <p>If you did not use any primers, and set <code>--primers NONE</code> then this information will be ignored  (you still have to provide this command-line flag but it won't be used)</p> </li> <li> <p>A named viral target via the <code>--target</code> or <code>--preset</code> flag.</p> <p>The given viral target will be used to enable an analysis-preset if ViroConstrictor is able to match your input to a known preset. If no preset is available then the default analysis settings will be used for the given viral-target. You can disable the use of analysis-presets with the <code>--disable-presets</code> flag.</p> </li> </ul> <p>Additional information that you can provide, but is not always required is the minimum coverage level (<code>--min-coverage</code>) as well as the primer-mismatch rate (<code>--primer-mismatch-rate</code>). When these flags are not provided then their default values are used during analysis.</p> <p>You can start a single-target analysis with a command such as the following:</p> <pre><code>viroconstrictor \\\n--input {path/to/FastQ-files} \\\n--output {path/to/desired/output/folder} \\\n--reference {path/to/reference.fasta / NONE} \\\n--primers {path/to/primers.fasta / NONE} \\\n--features {path/to/features.gff / NONE} \\\n--platform {nanopore/illumina/iontorrent} \\\n--amplicon-type {end-to-end/end-to-mid} \\\n--min-coverage {coverage level} \\\n--primer-mismatch-rate {mismatch rate} \\\n--target viral-target\n</code></pre>"},{"location":"manual/#run-a-multi-target-analysis","title":"Run a multi-target analysis","text":"<p>When running ViroConstrictor for multiple targets in a single analysis. Or if you want to set different analysis settings for every sample then you can run ViroConstrictor in multi-target analysis mode. A single analysis with different settings for each sample can be started by providing a samplesheet in Excel, CSV or TSV format.</p> <p>An example table can be seen below, or download the example excel spreadsheet here</p> Sample Virus Match-ref Primers Reference Features min-coverage primer-mismatch-rate Sample_1 SARS-CoV-2 FALSE /path/to/sars_cov_2_primers.fasta /path/to/sars_cov_2_reference.fasta /path/to/sars_cov_2.gff 50 0.1 Sample_2 Measles TRUE /path/to/Measles_primers.fasta /path/to/measles_reference.fasta /path/to/measles.gff 30 0.15 Sample_3 Influenza_A FALSE /path/to/Influenza-A_primers.fasta /path/to/Influenza-A_reference.fasta NONE 30 0.1 Sample_4 HPV TRUE NONE /path/to/HPV_reference.fasta NONE 10 0.1 <p>Attention</p> <p>Currently the <code>Match-ref</code> setting as portrayed in the table above as well as in the example spreadsheet is currently not yet implemented. This is a future functionality that is still being worked on, but we decided to include it already in the samplesheet and command-line arguments as we don't want to significantly change these formats going forward (unless actually deemed necessary). Setting the <code>Match-ref</code> to <code>TRUE</code> as in the example above will therefore not do anything in the analysis as per the current version.</p> <p>Please keep in mind that the Sample key as given in de samplesheet must correspond with the FastQ filename in your input directory. If this isn't the case then ViroConstrictor will let you know without running to ensure you won't get unexplainable data.</p> <p>The Virus column in the samplesheet will be used as the viral-target name for analysis. This named viral target will be used to enable an analysis-preset if ViroConstrictor is able to match your input to a known preset for analysis. If no preset is available then the default analysis settings will be used for the given viral-target. You can disable the use of analysis-presets with the <code>--disable-presets</code> flag.</p> <p>You can start a multi-target analysis with a command such as the following</p> <pre><code>viroconstrictor \\\n--input {path/to/FastQ-files} \\\n--output {path/to/desired/output/folder} \\\n--samplesheet {path/to/samplesheet.xlsx} \\\n--platform {nanopore/illumina/iontorrent} \\\n--amplicon-type {end-to-end/end-to-mid}\n</code></pre> <p>With a multi-target analysis it's also possible to combine run-wide parameters with a samplesheet. For example, you wish to analyse a batch of samples and set different minimum coverage values for every sample, but all other parameters in your analysis are the same. You can then leave out certain information in your samplesheet and supplement this information through the command line. Please note that in the given samplesheet, the columns \"Samples\", \"Virus\", and \"Reference\" are considered to be mandatory. starting an analysis without this information in the samplesheet will not work.</p>"}]}